#! /bin/bash
#
# Find NPM node_modules directories EVERYWHERE in the dev tree and deduce the 'root' directories.
# Then go and nuke those node_modules/* ENTIRELY to arrive at a clean, source-only system ready for a 'rebuild from scratch'.
#
# INCLUDE all source directories in our search so we also will uncover any project-specific test builds, etc.
#

# find all build files and list them for processing, i.e. deducing 'root dev build output directory detection':
dir="$1"
if test -z "$dir" ; then
	dir=.
fi
dir=$( realpath "$dir" )
cat <<EOT
Looking for NPM node_modules directories in the directory tree:

    $dir

----------------------------------------------------
EOT
find "$dir" -type d -name 'node_modules' > tmp.list
node nuke-all-npm-package-node_modules-directories.js tmp.list nuke-all-npm-node_modules-directories-exec.sh
rm tmp.list
./nuke-all-npm-node_modules-directories-exec.sh
